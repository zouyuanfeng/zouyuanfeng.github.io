<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">

    <!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <title>伤害计算</title>
</head>

<body style="margin: 0 auto;max-width: 500px;">
<div style="margin: 16px;">
    <div class="page-header">
        <h1>伤害计算器</h1>
    </div>
    <form class="form-horizontal">
        <div class="form-group">
            <label for="level" class="col-sm-3 control-label">攻击方等级</label>
            <div class="col-sm-4"><input type="number" class="form-control" id="level"></div>

            <label for="mega" class="col-sm-2 control-label">mega</label>
            <div class="col-sm-3">
                <select class="form-control" id="mega" title="请选择">
                    <option value="0" selected = "selected" >是</option>
                    <option value="1">否</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label for="power" class="col-sm-3 control-label">招式威力</label>
            <div class="col-sm-9">
                <input type="number" class="form-control" id="power"></div>
        </div>
        <div class="form-group">
            <label for="attack_power" class="col-sm-3 control-label">攻击力</label>
            <div class="col-sm-4">
                <input type="number" class="form-control" id="attack_power">
            </div>
            <label for="attack_add" class="col-sm-2 control-label">加成</label>
            <div class="col-sm-3">
                <select class="form-control" id="attack_add" title="请选择">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label for="defensive_power" class="col-sm-3 control-label">防御力</label>
            <div class="col-sm-4">
                <input type="number" class="form-control" id="defensive_power"></div>
            <label for="defensive_add" class="col-sm-2 control-label">加成</label>
            <div class="col-sm-3">
                <select class="form-control" id="defensive_add" title="请选择">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label for="department" class="col-sm-3 control-label">是否是本系</label>
            <div class="col-sm-9">
                <select class="form-control" id="department" title="请选择">
                    <option value="1">非本</option>
                    <option value="1.5">本系</option>
                    <option value="2">适应力</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label for="restraint" class="col-sm-3 control-label">克制系数</label>
            <div class="col-sm-9">
                <select class="form-control" id="restraint" title="请选择">
                    <option value="1">1倍</option>
                    <option value="1.5">1.5倍（坚石特性）</option>
                    <option value="2">2倍</option>
                    <option value="3">3倍（坚石特性）</option>
                    <option value="4">4倍</option>
                    <option value="0.5">0.5倍</option>
                    <option value="0.25">0.25倍</option>
                </select></div>
        </div>

        <div class="form-group">
            <label for="prop" class="col-sm-3 control-label">道具</label>
            <div class="col-sm-9">
                <input type="number" class="form-control" id="prop" placeholder="举例：力量头巾1.1，磁铁1.2，命玉1.3" value="1">
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-12">
                <button type="button" class="btn btn-default  btn-lg" style="float: right" onclick="calculate()">提交
                </button>
            </div>
        </div>
    </form>


    <div class="row">
        <div class="col-xs-3" style="text-align: right;font-size: 18px;margin-top: 3px">结果</div>
        <div class="col-xs-9" style="font-size: 18px"><span class="label label-success" style="flex-grow: 3"
                                                            id="result">0 ~ 0</span></div>
    </div>

    <footer style="float: right">
        参考资料：
        <a href="http://www.pokemon.name/wiki/%E4%BC%A4%E5%AE%B3%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%EF%BC%88%E7%AC%AC%E5%85%AD%E4%B8%96%E4%BB%A3%EF%BC%89">伤害计算公式</a>
    </footer>
</div>
</body>

<script>

    function calculate() {
        //攻击方等级
        var level = $("#level").val();
        //招式威力
        var power = $("#power").val();
        //攻击
        var attack_power = $("#attack_power").val();
        //攻击加成，如剑舞一次加成2
        var attack_add = $("#attack_add").val();
        //攻击=攻击+攻击*加成*(1/3)
        attack_power = parseInt(attack_power) + parseInt((attack_power * attack_add * (1 / 3)).toFixed(0));
        //防御
        var defensive_power = $("#defensive_power").val();

        var defensive_add = $("#defensive_add").val();

        defensive_power = parseInt(defensive_power) + parseInt((defensive_power * defensive_add * (1 / 3)).toFixed(0));
        //本系
        var department = $("#department").val();
        //克制
        var restraint = $("#restraint").val();
        //道具
        var prop = $("#prop").val();

        var mega=($("#mega").val()==='0')?34.64:26

        //浮动范围
        var floating_range = 0.793;

        // （攻击方等级 × 2 ÷ 5 + 2） × 技能威力 × 攻击方攻击力 ÷ 防御方防御力 ÷ 50 + 2
        //伤害值=26×((等级×0.4+2)×招式威力×攻击力/防御力/50+2)×道具×本系加成×克制关系×浮动范围×会心一击
        var result = (mega * ((level * 2 / 5 + 2) * power * attack_power / defensive_power / 50 + 2) * restraint * department * prop).toFixed(0);
        $("#result").text((result * floating_range).toFixed(0) + " ~ " + result);


    }
</script>
</html>

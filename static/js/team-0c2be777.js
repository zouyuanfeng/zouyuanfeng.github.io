import{k as O}from "./kx-1de81e01.js";import{_ as B,N as E,s as V,D as j,r as S,o as n,c as l,a as i,d as o,w as r,F as y,b as z,e as C,n as I,t as c,g as k,p as P,h as U}from "./index-7d1d6393.js";const q={name:"team",components:{NavBar:E},data(){return{activeNames:"0",team:{},teamNames:[],attribute:["\u666E","\u683C","\u98DE","\u6BD2","\u5730","\u5CA9","\u866B","\u9B3C","\u94A2","\u706B","\u6C34","\u8349","\u7535","\u8D85","\u51B0","\u9F99","\u6076","\u5996"],resistanceList:O,teamResistance:{},isResistance:!0,fontSize:11,userInfo:{},show:!1,actions:[]}},created(){this.update()},methods:{update(){let a=V.getItem("userInfo");if(!a.id){this.$router.replace("/login");return}let e=localStorage.getItem("teamNames")||[],b=localStorage.getItem("teamFontSize")||13;if(e.length===0)for(let h=1; h<=10; h++)e.push("\u961F\u4F0D"+h);this.setData({userInfo:a,teamNames:e,fontSize:Number(b)}),this.onLoadData()},onLoadData(){let a=this;this.$toast.loading("\u641C\u7D22\u4E2D.."),this.$http.get("/team/queryList",{openId:this.userInfo.id}).then(e=>{this.$toast.clear();let b=e.result,h={};b.forEach(d=>{h.hasOwnProperty(d.groupNum)||(h[d.groupNum]=[]),this.calculate(d),h[d.groupNum].push(d)});let s=[];for(const d in h)if(h.hasOwnProperty(d)){const p=h[d];let u=[],_=[];for(let v=0; v<18; v++)u.push(0),_.push(0);p.forEach(v=>{v.resistance.map((N, w)=>{N>1?_[w]+=1:N<1&&(u[w]+=1)})}),s.push({dk:u,rd:_})}a.setData({team:h,teamResistance:s})}, e=>{this.$toast.clear()})},calculate(a){if(a.attrs==="?"){a.resistance=[];return}let e=a.attrs.split(",");if(e.length===0)return;let b=this.attribute,h=e.map(p=>b.indexOf(p)),s=this.resistanceList,d=[];for(let p=0; p<18; p++){let u=h.filter(_=>_!=-1).map(_=>parseFloat(s[p][_])).reduce((_, v)=>_*v);d.push(u)}a.resistance=d},setData(a){Object.getOwnPropertyNames(a).forEach(e=>{this[e]=a[e]})},edit(){this.$router.push("/teamEdit")},setting(){this.actions=[{name:"\u653E\u5927\u5B57\u4F53"},{name:"\u7F29\u5C0F\u5B57\u4F53"},{name:this.isResistance?"\u9690\u85CF\u6297\u6027":"\u663E\u793A\u6297\u6027"}],this.show=!0},showOper(a){let e=[{name:"\u7F16\u8F91",item:a},{name:"\u5220\u9664",item:a}];a.pid!==-1&&e.push({name:"\u67E5\u770B\u7CBE\u7075\u9762\u677F",item:a}),this.actions=e,this.show=!0},onSelect({name:a,item:e}){switch(a){case"\u67E5\u770B\u7CBE\u7075\u9762\u677F":this.$router.push(`/detail?id=${e.pid}`);break;case"\u7F16\u8F91":this.$router.push(`/teamEdit?obj=${encodeURIComponent(JSON.stringify(e))}`);break;case"\u5220\u9664":this.del(e);break;case"\u653E\u5927\u5B57\u4F53":this.fontSize=this.fontSize+2,localStorage.setItem("teamFontSize",this.fontSize);break;case"\u7F29\u5C0F\u5B57\u4F53":this.fontSize=this.fontSize-2,localStorage.setItem("teamFontSize",this.fontSize);break;case"\u663E\u793A\u6297\u6027":this.isResistance=!0;break;case"\u9690\u85CF\u6297\u6027":this.isResistance=!1;break}},del(a){j.confirm({title:"\u63D0\u793A",message:"\u662F\u5426\u8981\u5220\u9664\u8BE5\u7CBE\u7075"}).then(()=>{this.$http.delete("/team/deleteById",{id:a.id}).then(e=>{this.$toast.clear(),e.code!==200?this.$toast(e.msg):(this.$toast("\u5220\u9664\u6210\u529F"),this.onLoadData())})}).catch(()=>{})}}},R= a=>(P("data-v-b1c4d502"),a=a(),U(),a),J={class:"page"},A={class:"page__bd"},G=["onClick"],H={class:"xg"},K={class:"nlz"},M={class:"nlz"},Q={class:"dj"},T={class:"jn"},W={class:"jn"},X={class:"tx"},Y={class:"jn"},Z={class:"jn"},$={class:"zz"},ee={class:"resistance1"},te=R(()=>i("div",null,"\u62B5\u6297\uFF1A",-1)),se={key:0,style:{color:"#000000"}},ae={key:1,style:{color:"#0000FF"}},ne={key:2,style:{color:"#0000FF","font-weight":"bold"}},oe={class:"resistance2"},ie=R(()=>i("div",null,"\u5F31\u70B9\uFF1A",-1)),le={key:0,style:{color:"#FF0000"}},re={key:1,style:{color:"#FF0000","font-weight":"bold"}},ce=R(()=>i("div",null,"\u7EFC\u5408\u62B5\u6297\uFF1A",-1)),ue={key:0,style:{color:"#0000FF"}},de=R(()=>i("div",null,"\u7EFC\u5408\u5F31\u70B9\uFF1A",-1)),_e={key:0,style:{color:"#FF0000"}},he={class:"fab-list"};function pe(a, e, b, h, s, d){const p=S("nav-bar"),u=S("van-col"),_=S("van-row"),v=S("van-collapse-item"),N=S("van-collapse"),w=S("van-icon"),L=S("van-action-sheet");return n(),l(y,null,[i("div",J,[o(p,{title:"\u914D\u7F6E\u961F\u4F0D"}),i("div",A,[o(N,{accordion:"",modelValue:s.activeNames,"onUpdate:modelValue":e[0]||(e[0]= f=>s.activeNames=f)},{default:r(()=>[(n(!0),l(y,null,z(s.team,(f, x, D)=>(n(),C(v,{name:x,title:s.teamNames[x],key:x},{default:r(()=>[(n(!0),l(y,null,z(f,(t, F)=>(n(),l("div",{style:I({fontSize:s.fontSize+"px"}),class:"team_item",key:F,onClick: g=>d.showOper(t)},[o(_,null,{default:r(()=>[o(u,{span:"14"},{default:r(()=>[i("div",{class:"mc",style:I({fontSize:s.fontSize+4+"px"})},c(t.pname?t.pname:"\u7CBE\u7075\u540D\u79F0"),5)]),_:2},1024),o(u,{span:"10"},{default:r(()=>[i("div",H,c(t.xg?t.xg:"\u6027\u683C"),1)]),_:2},1024)]),_:2},1024),o(_,{class:"line"},{default:r(()=>[o(u,{span:"8"},{default:r(()=>[i("div",K,c(t.attrs?t.attrs:"\u5C5E\u6027"),1)]),_:2},1024),o(u,{span:"8"},{default:r(()=>[i("div",M,c(t.efforts?t.efforts:"\u52AA\u529B\u503C"),1)]),_:2},1024),o(u,{span:"8"},{default:r(()=>[i("div",Q,c(t.prop?t.prop:"\u9053\u5177"),1)]),_:2},1024)]),_:2},1024),o(_,{class:"line"},{default:r(()=>[o(u,{span:"8"},{default:r(()=>[i("div",T,c(t.skill1?t.skill1:"\u6280\u80FD1"),1)]),_:2},1024),o(u,{span:"8"},{default:r(()=>[i("div",W,c(t.skill2?t.skill2:"\u6280\u80FD2"),1)]),_:2},1024),o(u,{span:"8"},{default:r(()=>[i("div",X,c(t.tx?t.tx:"\u7279\u6027"),1)]),_:2},1024)]),_:2},1024),o(_,{class:"line"},{default:r(()=>[o(u,{span:"8"},{default:r(()=>[i("div",Y,c(t.skill3?t.skill3:"\u6280\u80FD3"),1)]),_:2},1024),o(u,{span:"8"},{default:r(()=>[i("div",Z,c(t.skill4?t.skill4:"\u6280\u80FD4"),1)]),_:2},1024),o(u,{span:"8"},{default:r(()=>[i("div",$,c(t.superSkill?t.superSkill:"\u8D85\u7EA7\u62DB\u5F0F"),1)]),_:2},1024)]),_:2},1024),s.isResistance?(n(),C(_,{key:0,class:"line"},{default:r(()=>[o(u,{span:"12"},{default:r(()=>[i("div",ee,[te,(n(!0),l(y,null,z(t.resistance,(g, m)=>(n(),l("div",{class:"resistance",key:m},[g===0?(n(),l("div",se,c(s.attribute[m]),1)):g===.5?(n(),l("div",ae,c(s.attribute[m]),1)):g===.25?(n(),l("div",ne,c(s.attribute[m]),1)):k("",!0)]))),128))])]),_:2},1024),o(u,{span:"12"},{default:r(()=>[i("div",oe,[ie,(n(!0),l(y,null,z(t.resistance,(g, m)=>(n(),l("div",{key:m},[g===2?(n(),l("div",le,c(s.attribute[m]),1)):k("",!0),g>=4?(n(),l("div",re,c(s.attribute[m]),1)):k("",!0)]))),128))])]),_:2},1024)]),_:2},1024)):k("",!0)],12,G))),128)),s.isResistance?(n(),l("div",{key:0,style:I({fontSize:s.fontSize+"px"}),class:"resistance2"},[ce,(n(!0),l(y,null,z(s.teamResistance[D].dk,(t, F)=>(n(),l("div",null,[t>0?(n(),l("div",ue,c(t)+c(s.attribute[F]),1)):k("",!0)]))),256))],4)):k("",!0),s.isResistance?(n(),l("div",{key:1,style:I({fontSize:s.fontSize+"px"}),class:"resistance2"},[de,(n(!0),l(y,null,z(s.teamResistance[D].rd,(t, F)=>(n(),l("div",null,[t>0?(n(),l("div",_e,c(t)+c(s.attribute[F]),1)):k("",!0)]))),256))],4)):k("",!0)]),_:2},1032,["name","title"]))),128))]),_:1},8,["modelValue"])])]),i("div",he,[i("div",{class:"fab",onClick:e[1]||(e[1]=(...f)=>d.edit&&d.edit(...f))},[o(w,{name:"plus",color:"white"})]),i("div",{class:"fab",onClick:e[2]||(e[2]=(...f)=>d.setting&&d.setting(...f))},[o(w,{name:"setting-o"})]),o(L,{show:s.show,"onUpdate:show":e[3]||(e[3]= f=>s.show=f),actions:s.actions,onSelect:d.onSelect,"cancel-text":"\u53D6\u6D88","close-on-click-action":""},null,8,["show","actions","onSelect"])])],64)}const me=B(q,[["render",pe],["__scopeId","data-v-b1c4d502"]]);export{me as default};
